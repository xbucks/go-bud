# TODO: Currently no way to append to an existing file within the test suite
# This should pass though once we adjust the tests since it's working in di.

-- input.json --
{
  "dependencies": [
    {
      "import": "myapp.com/web",
      "type": "*Web"
    }
  ],
  "externals": [
  ],
  "target": "myapp.com/web"
}

-- expect.txt --
&web.Web{m: &web.Middleware{
  v: "v",
}}

-- main.go --
package main

import (
  "os"
  "fmt"
  "github.com/hexops/valast"
  web "myapp.com/web"
)

func main() {
  actual := web.Load()
  fmt.Fprintf(os.Stdout, "%s\n", valast.String(actual))
}

-- go.mod --
module myapp.com

require (
  github.com/hexops/valast v1.4.1
)

-- web/web.go --
package web

// Middlewares function
func Middlewares() *Middleware {
  return &Middleware{"v"}
}

// Middleware handler
type Middleware struct{
  v string
}

// New web
func New(m *Middleware) *Web {
  return &Web{m}
}

// Web struct
type Web struct {
  m *Middleware
}

